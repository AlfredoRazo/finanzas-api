<app-nav></app-nav>
<app-user></app-user>
<h3>Facturación</h3>
<hr class="red">
<ul class="nav nav-tabs">
  <li role="presentation" [class.active]="submenu==1"><a [routerLink]="" (click)="submenu=1">Consultas</a></li>
  <li role="presentation" [class.active]="submenu==2"><a [routerLink]="" (click)="submenu=2">Clientes</a></li>
  <li role="presentation" [class.active]="submenu==4"><a [routerLink]="" (click)="submenu=4">CFDI</a></li>
  <li role="presentation" [class.active]="submenu==5"><a [routerLink]="" (click)="submenu=5">Pagos</a></li>
  <li role="presentation" [class.active]="submenu==3"><a [routerLink]="" (click)="submenu=3">Reportes</a></li>
</ul>
<br>
<br>
<container-element [ngSwitch]="submenu">
  <div *ngSwitchCase="1">
    <form class="form-horizontal">
      <div class="form-group">
        <label class="col-sm-2 control-label" style="text-align: left !important;">Filtrar por: </label>
        <div class="col-sm-3">
          <select class="form-control">
            <option *ngFor="let item of filter" [value]="item">{{item}}</option>
          </select>
        </div>
        <div class="col-sm-5">
          <input type="email" class="form-control" placeholder="Criterio">
        </div>
        <div class="col-sm-2">
          <button class="btn btn-danger btn-block btn-sm" type="button">Buscar <span class="glyphicon glyphicon-search"
              aria-hidden="true"></span></button>
        </div>
      </div>
    </form>
    <br>
    <button type="button" class="btn btn-primary btn-sm" routerLink="nueva-consulta">Nueva consulta</button>
    <button type="button" class="btn btn-primary btn-sm" style="margin-left: 15px;"
      routerLink="consulta-por-tipo">Consulta por tipo</button>
    <br>
    <br>
    <div class="table-responsive">
      <table class="table table-bordered table-striped">
        <thead style="white-space: nowrap;">
          <tr style="cursor: pointer;">
            <th><input type="checkbox" [(ngModel)]="checkAll" (change)="checks()"></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="estatus">Estatus <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="noConsulta">Consulta de pago <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="fechaConsulta">Fecha de la consulta <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="tipoServicio">Tipo de servicio <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="factura">Factura <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="fechafactura">Fecha de la factura <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="cliente">Cliente <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="solicitante">Solicitante <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="UUID">UUID <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="subtotal">Subtotal <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="descuentos">Descuentos <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="iva">IVA <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="total">Total <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="fechaPago">Fecha de pago <span
                class="glyphicon glyphicon-sort"></span></th>
            <th scope="col" [appSort]="data" data-order="desc" data-name="referenciaPa">Referencia de pago <span
                class="glyphicon glyphicon-sort"></span></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of data">
            <td><input type="checkbox" [(ngModel)]="item.selected"></td>
            <td>{{item.estatus}}</td>
            <td>{{item.noConsulta}}</td>
            <td>{{item.fechaConsulta}}</td>
            <td>{{item.tipoServicio}}</td>
            <td>{{item.factura}}</td>
            <td>{{item.fechafactura}}</td>
            <td>{{item.cliente}}</td>
            <td>{{item.solicitante}}</td>
            <td>{{item.UUID}}</td>
            <td>{{item.subtotal}}</td>
            <td>{{item.descuentos}}</td>
            <td>{{item.iva}}</td>
            <td>{{item.total}}</td>
            <td>{{item.fechaPago}}</td>
            <td>{{item.referenciaPago}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <br>
    <button class="btn btn-primary" (click)="pagarMode()">Pagar</button>
    <br>
    <br>
    <p>Registros encontrados: <b>{{total}}</b></p>
    <ngb-pagination [collectionSize]="10" [(page)]="page"></ngb-pagination><br>
  </div>
  <div *ngSwitchCase="2">
    <app-clientes-table></app-clientes-table>
  </div>
  <div *ngSwitchCase="3"></div>
  <div *ngSwitchCase="4">
    <app-cfdi></app-cfdi>
  </div>
  <div *ngSwitchCase="5">
    <app-pagos></app-pagos><br>
  </div>
  <div *ngSwitchCase="6">
    <br>
    <input type="text" class="form-control" placeholder="Consulta de pago">
    <br>
    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>Subtotal</th>
          <th>Descuento</th>
          <th>IVA</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of apagar">
          <td>{{item.subtotal}}</td>
          <td>{{item.descuentos}}</td>
          <td>{{item.iva}}</td>
          <td>{{item.total}}</td>
        </tr>
        <tr>
          <td colspan="3">Total acumulado:</td>
          <td>{{totalApagar | currency}}</td>
        </tr>
      </tbody>
    </table>
    <br>
    <h4>Selecciona el banco a pagar: </h4>
    <br>
    <table style="width: 100%;">
      <tr>
        <td><img style="cursor: pointer;" (click)="sendPago('santander',totalApagar.toString())"
            src="assets/img/bancos/santander.gif" /></td>
        <td><img style="cursor: pointer;" (click)="sendPago('bbva',totalApagar.toString())"
            src="assets/img/bancos/bbva.gif" /></td>
        <td><img style="cursor: pointer;" src="assets/img/bancos/spei.gif" /></td>
        <td><img style="cursor: pointer;" src="assets/img/bancos/visa-master.gif" /></td>
      </tr>
    </table>
    <br>
    <br>
    <button class="btn btn-primary btn-sm" type="button" data-toggle="modal" data-target="#recibo">Imprimir</button>
    <button class="btn btn-primary btn-sm" style="margin-left: 10px;" (click)="submenu=1; apagar=[]; referencia = '';">Cancelar</button>
  </div>
</container-element>

<div class="modal fade bs-example-modal-lg" id="recibo" tabindex="-1" role="dialog" >
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Recibo</h4>
      </div>
      <div class="modal-body">
        <div id="contenido-imprimir" style="font-size: 0.8em">
          <img src="assets/img/headerpdf.png" width="100%">
          <h4 style="text-align: center;">Referencia de Pago</h4>

          <br>
          <br>
          <table style="width: 100%;">
            <tr>
              <td><b>Código de Registro</b></td>
              <td>0014932</td>
              <td><b></b></td>
              <td></td>
            </tr>
            <tr>
              <td><b>Tipo Entidad</b></td>
              <td>Administración Portuaria</td>
              <td><b>Entidad</b></td>
              <td>API MANZANILLO</td>
            </tr>
            <tr>
              <td><b>Usuario</b></td>
              <td>Salvador</td>
              <td><b>Servidor Remoto</b></td>
              <td>10.34.71.118</td>
            </tr>
            <tr>
              <td><b>Fecha</b></td>
              <td>24/07/2021 00:00</td>
              <td><b>Fecha Límite de Pago</b></td>
              <td>31/07/2021</td>
            </tr>
            <tr>
              <td><b>Estatus</b></td>
              <td>En proceso...</td>
              <td><b>Referencia</b></td>
              <td>{{referencia}}</td>
            </tr>
          </table>

          <br><br>
          <table style="width: 100%;">
            <tr>
              <th>Código</th>
              <th>Cliente</th>
              <th>Tipo</th>
              <th>Referencia</th>
              <th>Fecha</th>
              <th>Subtotal</th>
              <th>IVA</th>
              <th>Total</th>
            </tr>
            <tr *ngFor="let item of apagar">
              <td>{{item.noConsulta}}</td>
              <td>{{item.cliente}}</td>
              <td>{{item.tipoServicio}}</td>
              <td>00000001</td>
              <td>{{item.fechaConsulta}}</td>
              <td>{{item.subtotal}}</td>
              <td>{{item.iva}}</td>
              <td>{{item.total}}</td>
            </tr>
            <tr>
              <td colspan="6"></td>
              <td colspan="2"><b>{{totalApagar | currency}}</b></td>
              <td></td>
            </tr>
          </table>
          <br>
          <br>
          <br>
          <h4>Información de pago</h4>
          <h3>Válido para pagar únicamente en Santander</h3>
          <h3>Referencia {{referencia}}</h3>
          <h3>Convenio 7164</h3>
          <h3>Importe {{totalApagar}}</h3>
          <h3>Fecha limite de pago 31/07/2021</h3>
          <h3>Has seleccionado depósito referenciado, continua desde el portal electrónico de tu preferencia, selecciona SPEI referenciado y coloca la referencia bancaria que se generó en PSP. Coloca ESTRICTAMENTE la clave referenciada en el 'CONCEPTO'.
            PA: 4445-01 Puerto Sin Papeles</h3>
          

        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-primary" (click)="imprimir()">Imprimir</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!--button type="button" class="btn btn-default" routerLink="/main">Regresar</button-->